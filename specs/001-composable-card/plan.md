<!--
==============================================================================
DOCUMENT PURPOSE: Design HOW to implement spec.md requirements (Implementation)
==============================================================================

This plan describes the technical solution for developers implementing the
component. It bridges the gap between "what we need" (spec) and "what we do" (tasks).

FOCUS: HOW
- How to implement the requirements
- What technologies and patterns to use
- How files should be organized

✅ INCLUDE in plan.md:
- Technical approach and architecture decisions
- Complete TypeScript interface definitions with code
- React component patterns and examples
- Sass/CSS implementation patterns with code
- File structure and organization details
- Import strategies and module dependencies
- Migration strategies for existing code
- Code examples showing HOW to implement each requirement

❌ EXCLUDE from plan.md (belongs in spec.md):
- Requirements explanations and rationale
- User scenarios and acceptance criteria
- Success criteria and measurable outcomes
- Why features are needed (business justification)

❌ EXCLUDE from plan.md (belongs in tasks.md):
- Granular task lists with file paths
- Specific commands to run
- Task execution order and dependencies
- Step-by-step instructions

AUTOMATION:
- Auto-generated by `/speckit.plan` from spec.md requirements
- Derives implementation patterns from spec constraints
- Feeds into `/speckit.tasks` for task generation

VALIDATION:
- Every spec requirement should have implementation guidance
- Code examples should be complete and executable
- Patterns should follow Backpack constitution principles
==============================================================================
-->

# Implementation Plan: BpkCardV2

**Package Branch**: `001-composable-card` | **Date**: 2026-01-28 | **Spec**: [spec.md](./spec.md)
**Input**: Component specification from `/specs/001-composable-card/spec.md`

## Summary

**BpkCardV2** is a composable, responsive card component for Backpack that supports multi-area layouts (split layout with 70/30 ratio), optional header/footer sections, multiple surface color variants, and automatic mobile-first responsive behavior. The component uses explicit subcomponents (Header, Body, Primary, Secondary, Footer) to enable clear composition without implicit child ordering. It supports 8 Backpack surface color tokens via `bgColor` prop, 2 visual variants ("default", "outlined"), and responsive split layout controlled by `split` and `splitRatio` props on the Body component.

## Technical Context

**Framework**: React 18.3.1 with TypeScript 5.9.2
**Styling**: CSS Modules + Sass (modern API with `@use`)
**Testing**: Jest 30 + Testing Library + jest-axe
**Build Tools**: Webpack 5, Babel 7
**Linting**: ESLint (@skyscanner/eslint-config-skyscanner), Stylelint
**Component Library**: Backpack Design System (Monorepo)
**Package Manager**: npm >=10.7.0
**Node Version**: >=18.20.4
**Target Browsers**: Chrome 109+, Edge 129+, Firefox 131+, Safari 15+, Samsung 26+
**Performance Goals**: Meet test coverage thresholds (70% branches, 75% functions/lines/statements)
**Constraints**: Must follow Backpack constitution and architecture decisions
**Scale/Scope**: Single reusable component in `packages/bpk-component-[name]/`

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Core Principles Compliance

- [x] **Component-First Architecture**: Package structure in `packages/bpk-component-card-v2/`
- [x] **Naming Conventions**: PascalCase for `BpkCardV2`, `.module.scss` for styles, `*-test.tsx` for tests
- [x] **License Headers**: All source files include Apache 2.0 license header at the top
- [x] **Modern Sass**: Using `@use` syntax with granular imports from `bpk-mixins`
- [x] **Accessibility-First**: Includes `accessibility-test.tsx` with jest-axe; semantic HTML (header/footer tags); keyboard navigation
- [x] **TypeScript**: All code written in TypeScript with proper types; explicit prop interfaces
- [x] **SemVer**: MINOR version bump (new component, no breaking changes)
- [x] **Deprecation Management**: N/A for V1 (new component, no deprecations)
- [x] **Test Coverage**: Will meet 70% branches, 75% functions/lines/statements
- [x] **Documentation**: Includes README.md, Storybook stories (8 surface colors + variants), JSDoc comments, Figma Code Connect

### Technology Compliance

- [x] **React Version**: Using React 18.3.1
- [x] **TypeScript Version**: Using TypeScript 5.9.2
- [x] **CSS Modules**: All styles use `.module.scss` extension
- [x] **rem Units**: All sizing values use `rem` (not `px` or `em`)
- [x] **Design Tokens**: Uses tokens from `@skyscanner/bpk-foundations-web` (surface colors, shadows) and `bpk-mixins`
- [x] **BEM Naming**: CSS classes follow BEM with `bpk-` prefix (e.g., `bpk-card-v2`, `bpk-card-v2__header`)
- [x] **RTL Support**: Component supports right-to-left languages (flexbox + logical properties)
- [x] **Browser Support**: Works on Chrome 109+, Edge 129+, Firefox 131+, Safari 15+, Samsung 26+

✅ **Constitution Check PASSED** - All principles and technology constraints are satisfied.

### Testing Compliance

- [ ] **Unit Tests**: Jest + Testing Library tests in `[ComponentName]-test.tsx`
- [ ] **Accessibility Tests**: jest-axe tests in `accessibility-test.tsx`
- [ ] **Visual Tests**: Percy tests via Storybook (unless component uses images)
- [ ] **Snapshot Tests**: Included for all variants
- [ ] **Coverage Thresholds**: Meets required percentages

### Documentation Compliance

- [ ] **British English**: Prose uses British English, code uses US English
- [ ] **Sentence Case**: Titles use sentence case, singular form
- [ ] **<100 Words**: Component description under 100 words
- [ ] **Storybook**: Stories in `examples/bpk-component-[name]/stories.tsx`
- [ ] **JSDoc**: All public APIs documented
- [ ] **Figma Connect**: `.figma.tsx` file connects to Figma designs

## Implementation Architecture

### Component Design Approach

**BpkCardV2** follows a **composable subcomponent pattern** inspired by Ark UI:

1. **Root Component** (`BpkCardV2`): Container with `variant` and `bgColor` props
2. **Subcomponents** (explicit composition):
   - `BpkCardV2.Header` - Optional semantic `<header>` element
   - `BpkCardV2.Body` - Content container with split layout support
   - `BpkCardV2.Primary` - Left/main content area (flex-1, ~70%)
   - `BpkCardV2.Secondary` - Right/sidebar area (~30%)
   - `BpkCardV2.Footer` - Optional semantic `<footer>` element

3. **Key Design Decisions**:
   - Explicit subcomponents prevent implicit child ordering ambiguity
   - Split layout managed via `split` and `splitRatio` props on Body
   - Responsive behavior built-in (mobile stacking, desktop side-by-side)
   - Visual divider (1px with 4px inset) always renders in split layouts on desktop
   - Surface colors orthogonal from variants: `variant` = visual treatment, `bgColor` = background color

### Styling Strategy

- **CSS Modules**: All styles in `.module.scss` for scoping
- **BEM Naming**: Root class `bpk-card-v2` with modifiers (`--default`, `--outlined`)
- **Tokens**: Surface colors from `@skyscanner/bpk-foundations-web` surface tokens
- **Responsive**: Breakpoint at 768px (mobile < 768px, desktop >= 768px)
- **RTL**: Flexbox with logical properties (no left/right, use start/end)
- **Sizing**: All dimensions in `rem` units

## Project Structure

### Documentation (this component)

```text
specs/[###-component-name]/
├── spec.md              # Component specification
├── plan.md              # This file (/speckit.plan command output)
├── research.md          # Phase 0 output (/speckit.plan command)
├── api-design.md        # Phase 1 output (/speckit.plan command)
├── styling-guide.md     # Phase 1 output (/speckit.plan command)
└── tasks.md             # Phase 2 output (/speckit.tasks command - NOT created by /speckit.plan)
```

**Note**: Storybook examples are created in `examples/bpk-component-[name]/` directory (separate from specs), not within the specs directory.

### Package Structure (Backpack Monorepo)

```text
packages/bpk-component-card-v2/
├── README.md                     # Component documentation (British English prose)
├── index.ts                      # Export entry point (exports from src/)
├── docs/                         # Documentation assets
│   ├── screenshots/              # Component screenshots for README
│   └── design-assets/            # Figma exports, design references
└── src/
    └── BpkCardV2/               # Component directory
        ├── BpkCardV2.tsx                # Root component implementation
        ├── BpkCardV2.module.scss        # CSS Modules styles
        ├── BpkCardV2-test.tsx           # Unit tests (Jest + Testing Library)
        ├── accessibility-test.tsx       # Accessibility tests (jest-axe)
        ├── BpkCardV2.figma.tsx          # Figma Code Connect
        ├── subcomponents/
        │   ├── Header.tsx               # Header subcomponent
        │   ├── Body.tsx                 # Body subcomponent with split logic
        │   ├── Primary.tsx              # Primary area subcomponent
        │   ├── Secondary.tsx            # Secondary area subcomponent
        │   └── Footer.tsx               # Footer subcomponent
        ├── common-types.ts              # Shared TypeScript types
        └── __snapshots__/               # Jest snapshot files
            └── BpkCardV2-test.tsx.snap
```

### Storybook Examples

```text
examples/bpk-component-[name]/
├── stories.tsx                    # Storybook story definitions (CSF 3.0)
├── examples.tsx                   # Example component implementations
├── [ComponentName]Story.module.scss # Styles for examples (if needed)
└── README.md                      # Example documentation (optional)
```

**Structure Decision**: Backpack uses a Monorepo architecture where each component is a separate package in `packages/`. This enables:
- Independent versioning per component
- Clear dependency boundaries
- Isolated testing and documentation
- Easier maintenance and updates

## Complexity Tracking

> **Fill ONLY if Constitution Check has violations that must be justified**

| Violation | Why Needed | Simpler Alternative Rejected Because |
|-----------|------------|-------------------------------------|
| [e.g., Using external dependency X] | [specific problem it solves] | [why Backpack's built-in solution insufficient] |
| [e.g., Not using CSS Modules] | [technical constraint] | [why standard approach won't work] |

If no violations: **No constitution violations. Component follows all Backpack standards.**

## Phase 0: Research & Discovery

**Objective**: Understand existing patterns and gather context

### Research Tasks

1. **Survey Existing Components**:
   - Review similar components in `packages/` (e.g., buttons, cards, inputs)
   - Identify reusable patterns and common approaches
   - Check for existing utilities in `bpk-react-utils`
   - Review design tokens in `@skyscanner/bpk-foundations-web`

2. **Review Sass Mixins**:
   - Explore `packages/bpk-mixins/` for relevant utilities
   - Identify which mixins to import (tokens, typography, shadows, etc.)
   - Check modern Sass API usage examples

3. **Study Testing Patterns**:
   - Review test files in similar components
   - Understand jest-axe usage patterns
   - Check Storybook story structures in `examples/`

4. **Figma Design Review**:
   - Review Figma designs and specifications
   - Identify all visual states (default, hover, focus, active, disabled)
   - Note responsive behavior and breakpoints
   - Document design token mappings

5. **Architecture Decisions Review**:
   - Read relevant files in `decisions/` directory
   - Understand naming conventions (js-filenames.md, component-scss-filenames.md)
   - Review modern Sass API requirements (modern-sass-api.md)
   - Check versioning rules (versioning-rules.md)
   - Understand deprecation policies (deprecated-api.md, future-api.md)

**Deliverable**: `research.md` documenting findings and patterns to follow

---

## BpkCardV2 Specific Design

### Component API & Type Definitions

```typescript
// Root component
type BpkCardV2Props = {
  variant?: 'default' | 'outlined';
  bgColor?: 'surfaceDefault' | 'surfaceElevated' | 'surfaceTint' | 'surfaceSubtle' | 'surfaceHero' | 'surfaceContrast' | 'surfaceLowContrast' | 'surfaceHighlight';
  children: ReactNode;
  className?: string;
  ariaLabel?: string;
  ariaLabelledBy?: string;
};

// Body component with split layout support
type BpkCardV2BodyProps = {
  children: ReactNode;
  className?: string;
  split?: boolean;
  splitRatio?: number; // 0-100, default 70
};

// Header & Footer
type BpkCardV2HeaderProps = {
  children: ReactNode;
  className?: string;
};

type BpkCardV2FooterProps = {
  children: ReactNode;
  className?: string;
};

// Primary & Secondary (used within Body with split=true)
type BpkCardV2PrimaryProps = {
  children: ReactNode;
  className?: string;
};

type BpkCardV2SecondaryProps = {
  children: ReactNode;
  className?: string;
};
```

### CSS Class Structure & Styling

**BEM Classes**:
```scss
.bpk-card-v2 { /* Root container */ }
.bpk-card-v2--default { /* Default variant */ }
.bpk-card-v2--outlined { /* Outlined variant */ }
.bpk-card-v2__header { /* Header section */ }
.bpk-card-v2__body { /* Body section */ }
.bpk-card-v2__body--split { /* Body with split layout */ }
.bpk-card-v2__primary { /* Primary area in split */ }
.bpk-card-v2__divider { /* Vertical divider */ }
.bpk-card-v2__secondary { /* Secondary area in split */ }
.bpk-card-v2__footer { /* Footer section */ }
```

**Sass Design Token Mapping**:
```scss
// Colors (from Backpack surface tokens)
.bpk-card-v2 {
  // Default variant styling
  background-color: var(--bpk-surface-default, #ffffff);
  border-radius: tokens.bpk-border-radius-md();

  // Shadow for default variant (small shadow)
  box-shadow: var(--bpk-component-shadow-small);

  // Outlined variant
  &--outlined {
    border: 1px solid tokens.$bpk-color-border;
    box-shadow: none;
  }

  // Hover/press state (elevated shadow)
  &:hover {
    box-shadow: var(--bpk-component-shadow-large);
  }
}

// Surface color support (using Backpack design tokens with -day suffix)
.bpk-card-v2 {
  background-color: tokens.$bpk-surface-default-day; // default

  &[data-bg-color="surfaceElevated"] {
    background-color: tokens.$bpk-surface-elevated-day;
  }
  &[data-bg-color="surfaceTint"] {
    background-color: tokens.$bpk-surface-tint-day;
  }
  &[data-bg-color="surfaceSubtle"] {
    background-color: tokens.$bpk-surface-subtle-day;
  }
  &[data-bg-color="surfaceHero"] {
    background-color: tokens.$bpk-surface-hero-day;
  }
  &[data-bg-color="surfaceContrast"] {
    background-color: tokens.$bpk-surface-contrast-day;
  }
  &[data-bg-color="surfaceLowContrast"] {
    background-color: tokens.$bpk-surface-low-contrast-day;
  }
  &[data-bg-color="surfaceHighlight"] {
    background-color: tokens.$bpk-surface-highlight-day;
  }
}
// Note: -day suffix enables automatic night theme support via Backpack theming system

// Split layout styling
.bpk-card-v2__body--split {
  display: flex;
  gap: 0;

  @media (max-width: 767px) {
    flex-direction: column;
  }

  @media (min-width: 768px) {
    flex-direction: row;
  }
}

.bpk-card-v2__primary {
  @media (min-width: 768px) {
    flex: 1 1 calc(70% - 0.5rem); // Adjust for divider
  }
}

.bpk-card-v2__divider {
  @media (min-width: 768px) {
    width: 1px;
    background-color: tokens.$bpk-color-border;
    margin: tokens.bpk-spacing-sm() 0; // 4px inset
  }

  @media (max-width: 767px) {
    display: none;
  }
}

.bpk-card-v2__secondary {
  @media (min-width: 768px) {
    flex: 0 0 30%;
  }
}
```

**Responsive Behavior**:
- Mobile (<= 767px): Sections stack vertically, divider hidden, 100% width
- Desktop (>= 768px): Sections side-by-side, divider visible (1px), ratio applied

**RTL Support**:
- Use flexbox with `flex-direction` (automatically reverses in RTL)
- No left/right properties; use `margin-inline`, `padding-inline` etc.
- Text alignment uses logical properties

---

## Phase 1: Design & Planning

**Objective**: Design component API and structure before implementation

### API Design

**Deliverable**: `api-design.md` containing:

1. **Component Props Interface**:
```typescript
type Bpk[ComponentName]Props = {
  // Define all props with types, defaults, and documentation
  variant: 'primary' | 'secondary' | 'tertiary';
  size?: 'small' | 'medium' | 'large'; // default: 'medium'
  disabled?: boolean; // default: false
  className?: string;
  children?: ReactNode;
  onClick?: (event: MouseEvent<HTMLElement>) => void;
  ariaLabel?: string;
  // ... other props
};
```

2. **Component Composition**:
   - If component is composed of sub-components, define their interfaces
   - Document how they work together
   - Example: `BpkAccordion` + `BpkAccordionItem`

3. **Theming Support**:
   - If component is themeable, define theme attributes in `themeAttributes.ts`
   - Document which properties can be themed
   - Example theme attributes for customization

4. **Accessibility Considerations**:
   - ARIA attributes required
   - Keyboard navigation support (Tab, Enter, Space, etc.)
   - Screen reader announcements
   - Focus management

### Styling Design

**Deliverable**: `styling-guide.md` containing:

1. **CSS Class Structure** (BEM with `bpk-` prefix):
```scss
.bpk-component-name { /* base class */ }
.bpk-component-name--primary { /* variant modifier */ }
.bpk-component-name--disabled { /* state modifier */ }
.bpk-component-name__element { /* child element */ }
```

2. **Sass Imports** (granular from `bpk-mixins`):
```scss
@use '../bpk-mixins/tokens';
@use '../bpk-mixins/typography';
@use '../bpk-mixins/shadows';
@use '../bpk-mixins/borders';
@use '../bpk-mixins/utils';
```

3. **Design Token Mapping**:
   - Map design specs to Backpack tokens
   - Spacing: `tokens.bpk-spacing-*()` (returns rem values)
   - Colors: `tokens.$bpk-color-*`
   - Typography: `typography.bpk-text()`, `typography.bpk-label-1()`, etc.
   - Shadows: `shadows.bpk-box-shadow-*()` mixins
   - Border radius: `tokens.bpk-border-radius-*()` or `borders.bpk-border-radius-*()` mixins

4. **Responsive Behavior**:
   - Define breakpoint behavior (mobile, tablet, desktop)
   - Use Backpack's responsive mixins if applicable

5. **RTL Support**:
   - Document directional properties (margin, padding, text-align)
   - Use logical properties where applicable
   - Test with `isRTL` utility from `bpk-react-utils`

### Storybook Examples

**Deliverable**: Storybook stories in `examples/bpk-component-[name]/` directory:

1. **`stories.tsx`**: Storybook story definitions using CSF 3.0 format
   - Default story with minimal props
   - Stories for all variants and sizes
   - Stories for interactive states (hover, focus, active, disabled)
   - Stories for edge cases (long text, empty states, errors)
   - Accessibility stories demonstrating keyboard navigation

2. **`examples.tsx`**: Example component implementations
   - Reusable example components used by stories
   - Visual demonstrations of all component features
   - Edge case demonstrations

3. **`*.module.scss`** (if needed): Styles for example layouts and demonstrations

**Note**: Examples are written as Storybook stories, not as separate standalone files. All examples are contained within the `examples/bpk-component-[name]/` directory structure.

## Phase 2: Task Breakdown

**Objective**: Create detailed implementation tasks

**Note**: This phase is executed by `/speckit.tasks` command, NOT by `/speckit.plan`

**Deliverable**: `tasks.md` with sequenced implementation tasks organized by:
- Phase 1: Setup (package initialization)
- Phase 2: Core Implementation (component code)
- Phase 3: Styling (SCSS and theming)
- Phase 4: Testing (unit, accessibility, visual)
- Phase 5: Documentation (README, Storybook, JSDoc)
- Phase 6: Integration (Figma Code Connect, package publishing)

## Dependencies

### Internal Backpack Dependencies

**Design Foundations** (REQUIRED):
- `@skyscanner/bpk-foundations-web`: Design tokens for 8 surface colors, shadows, spacing, border-radius
- `packages/bpk-mixins/`: Sass mixins (tokens, shadows, borders, responsive utilities)

**React Utilities** (OPTIONAL):
- `bpk-react-utils`: May use `isRTL` utility for RTL support testing
- `bpk-theming`: Not needed for V1 (theming via design tokens only)

**Component Dependencies**:
- NONE - BpkCardV2 is a standalone layout component
- Does NOT compose with other Backpack components
- Pure composition via subcomponents (Header, Body, Primary, Secondary, Footer)

### External Dependencies

**Peer Dependencies** (already in project):
- `react: ^18.3.1` - For React component implementation
- `react-dom: ^18.3.1` - For DOM rendering

**No Additional External Dependencies**:
- Component uses only Backpack design tokens and Sass
- No third-party libraries required
- Composition is native React, not reliant on external UI libraries

**Development Dependencies** (already in project):
- TypeScript 5.9.2, Jest 30, Testing Library, jest-axe, Percy, ESLint, Stylelint

## Testing Strategy

### Unit Tests (`Bpk[ComponentName]-test.tsx`)

**Framework**: Jest 30 + Testing Library

**Test Coverage**:
1. **Rendering Tests**:
   - Renders with required props
   - Renders with optional props
   - Renders all variants (e.g., primary, secondary, tertiary)
   - Renders all sizes (e.g., small, medium, large)
   - Renders with custom className
   - Renders with children

2. **Interaction Tests**:
   - onClick handler called when clicked
   - Keyboard interactions (Enter, Space)
   - Focus management

3. **State Tests**:
   - Disabled state prevents interactions
   - Loading state (if applicable)
   - Error state (if applicable)

4. **Edge Cases**:
   - No props provided (uses defaults)
   - Null/undefined children
   - Extremely long text
   - Invalid prop values (should gracefully handle or error)

5. **Snapshot Tests**:
   - Snapshot for each variant + size combination
   - Snapshot for disabled state
   - Snapshot for edge cases

**Coverage Target**: 70% branches, 75% functions/lines/statements

### Accessibility Tests (`accessibility-test.tsx`)

**Framework**: jest-axe

**Test Coverage**:
1. **Automated Checks**:
   - No accessibility violations detected by axe
   - Test all variants and states
   - Test with different content (text, icons, etc.)

2. **ARIA Attributes**:
   - Correct role (if applicable)
   - aria-label or aria-labelledby present when needed
   - aria-disabled for disabled state
   - aria-pressed for toggle buttons (if applicable)

3. **Keyboard Navigation**:
   - Tab to focus component
   - Enter/Space to activate (if interactive)
   - Focus visible (outline or focus indicator)

4. **Screen Reader**:
   - Test that component announces correctly
   - Test state changes are announced
   - Test with actual screen readers (manual testing)

**Important**: Test the public interface. If component is composed (e.g., `BpkAccordion` with `BpkAccordionItem`), test them together as they would be used by consumers.

### Visual Regression Tests (Percy via Storybook)

**Framework**: Percy + Storybook

**Test Coverage** (if component does NOT use images):
1. All visual variants (primary, secondary, tertiary)
2. All sizes (small, medium, large)
3. Interactive states (hover, focus, active, disabled)
4. Edge cases (long text, empty, error states)
5. Responsive breakpoints (mobile, tablet, desktop)
6. RTL rendering

**Exception**: If component uses images (e.g., `BpkImage`, `BpkCard` with images), do NOT add visual tests. Per `decisions/visual-tests.md`, image loading is flaky on CI and causes false positives.

### Integration Tests (if applicable)

**Framework**: Jest + Testing Library

**Test Coverage** (only if component composes with other components):
- Test integration with other Backpack components
- Test theming integration (if themeable)
- Test in realistic usage scenarios

## Documentation Requirements

### README.md (British English prose, <100 words)

**Structure**:
1. **Title**: Component name in sentence case (e.g., "Bar chart")
2. **Description**: Plain English, describe purpose (not configuration)
3. **Installation**: `npm install @skyscanner/backpack-web`
4. **Usage**: Code example with basic usage
5. **Props**: Table with prop name, type, default, description
6. **Browser Support**: Link to browser support info
7. **Accessibility**: Brief note on accessibility features
8. **Related Components**: Links to related Backpack components
9. **Figma**: Link to Figma designs

**Example**:
```markdown
# Bar chart

A simple bar chart component for displaying data visually with customisable
colours and labels. Ideal for presenting comparative data in a clear format.

## Installation

npm install @skyscanner/backpack-web

## Usage

import BpkBarchart from '@skyscanner/backpack-web/bpk-component-barchart';

<BpkBarchart data={chartData} />

[Props table, examples, etc.]
```

### Storybook Stories (`examples/bpk-component-[name]/stories.tsx`)

**Stories to include**:
1. **Default**: Basic usage with minimal props
2. **Variants**: All visual variants (primary, secondary, tertiary)
3. **Sizes**: All sizes (small, medium, large)
4. **States**: Interactive states (hover, focus, active, disabled)
5. **With Content**: With children, icons, or other content
6. **Edge Cases**: Long text, empty, error states
7. **Responsive**: Mobile, tablet, desktop views
8. **Accessibility**: Keyboard navigation demo, screen reader support

**Storybook Configuration**:
- Use CSF (Component Story Format) 3.0
- Add a11y addon for accessibility checks
- Use controls for interactive prop editing
- Add JSDoc comments to stories for documentation

**Example**:
```typescript
import type { Meta, StoryObj } from '@storybook/react';
import Bpk[ComponentName] from './Bpk[ComponentName]';

const meta: Meta<typeof Bpk[ComponentName]> = {
  title: 'Components/Bpk[ComponentName]',
  component: Bpk[ComponentName],
};

export default meta;
type Story = StoryObj<typeof Bpk[ComponentName]>;

export const Default: Story = {
  args: {
    variant: 'primary',
  },
};

export const AllVariants: Story = {
  render: () => (
    <>
      <Bpk[ComponentName] variant="primary">Primary</Bpk[ComponentName]>
      <Bpk[ComponentName] variant="secondary">Secondary</Bpk[ComponentName]>
      <Bpk[ComponentName] variant="tertiary">Tertiary</Bpk[ComponentName]>
    </>
  ),
};
```

### JSDoc/TSDoc Comments

**Requirements**:
- Every component must have a JSDoc comment
- Every prop must be documented
- Use `@deprecated` for deprecated props
- Include examples in JSDoc where helpful
- Use British English for prose, US English for code

**Example**:
```typescript
/**
 * Bpk[ComponentName] is a component for [purpose].
 *
 * It supports multiple variants (primary, secondary, tertiary) and sizes.
 *
 * @example
 * <Bpk[ComponentName] variant="primary" size="medium">
 *   Click me
 * </Bpk[ComponentName]>
 */
type Bpk[ComponentName]Props = {
  /**
   * Visual variant of the component.
   */
  variant: 'primary' | 'secondary' | 'tertiary';

  /**
   * Size of the component.
   * @default 'medium'
   */
  size?: 'small' | 'medium' | 'large';

  /**
   * Whether the component is disabled.
   * @default false
   */
  disabled?: boolean;

  /**
   * @deprecated Use `size` prop instead. Will be removed in v11.0.0.
   */
  large?: boolean;
};
```

### Figma Code Connect (`.figma.tsx`)

**Purpose**: Connect component to Figma designs for design-to-code workflow

**Example**:
```typescript
import { figma } from '@figma/code-connect';
import Bpk[ComponentName] from './Bpk[ComponentName]';

figma.connect(Bpk[ComponentName], 'https://www.figma.com/file/...', {
  props: {
    variant: figma.enum('Variant', {
      Primary: 'primary',
      Secondary: 'secondary',
      Tertiary: 'tertiary',
    }),
    size: figma.enum('Size', {
      Small: 'small',
      Medium: 'medium',
      Large: 'large',
    }),
    disabled: figma.boolean('Disabled'),
  },
  example: (props) => <Bpk[ComponentName] {...props}>Label</Bpk[ComponentName]>,
});
```

## Migration & Versioning

### Version Determination (per `decisions/versioning-rules.md`)

**This component is**: [Select one]
- [x] **NEW COMPONENT** → **MINOR** version bump for `@skyscanner/backpack-web`
- [ ] **MAJOR UPDATE** → **MAJOR** version bump (breaking API/visual changes)
- [ ] **ENHANCEMENT** → **MINOR** version bump (new optional features)
- [ ] **BUG FIX** → **PATCH** version bump

**Rationale**: BpkCardV2 is a new component (not a replacement of BpkCard). Consumers must explicitly import and adopt it. Existing code continues to work with BpkCard. This is a MINOR version bump (adds new functionality without breaking existing APIs). Version applies to `@skyscanner/backpack-web` package.

### Breaking Changes (if MAJOR)

**API Changes**:
- [Old API] → [New API]
- [Prop removed] → [Alternative]
- [Behavior changed] → [New behavior]

**Visual Changes**:
- [Old appearance] → [New appearance]
- [Token change] → [Impact]

**Migration Guide**:
```typescript
// Before (old API)
<Bpk[ComponentName] oldProp="value" />

// After (new API)
<Bpk[ComponentName] newProp="value" />
```

**Timeline**: [Date when breaking change will be released]

### Deprecations (if applicable)

**Deprecated APIs** (minimum 3 months before removal):
- `oldProp` → Use `newProp` instead
- `OldComponent` → Use `NewComponent` instead

**Deprecation Implementation**:
```typescript
type Bpk[ComponentName]Props = {
  newProp: string;

  /**
   * @deprecated oldProp is deprecated. Use newProp instead. Will be removed in v11.0.0.
   */
  oldProp?: string;
};

const Bpk[ComponentName] = ({ newProp, oldProp }: Bpk[ComponentName]Props) => {
  if (oldProp) {
    console.warn('oldProp is deprecated. Use newProp instead. Will be removed in v11.0.0.');
  }

  const effectiveProp = newProp || oldProp;
  // ...
};
```

### Future API (if applicable)

**Opt-in V2 Component** (minimum 3 months before becoming default):
- `Bpk[ComponentName]` (current) → `Bpk[ComponentName]V2` (future)
- Consumers can opt-in to V2 early
- In next MAJOR version, V2 becomes default and V1 is removed

**Example**:
```typescript
// Current usage
import Bpk[ComponentName] from '@skyscanner/backpack-web/bpk-component-name';

// Opt-in to future API
import Bpk[ComponentName]V2 from '@skyscanner/backpack-web/bpk-component-name/Bpk[ComponentName]V2';
```

## Release Checklist

Before releasing this component:

- [ ] All constitution checks pass
- [ ] All tests pass (unit, accessibility, visual)
- [ ] Test coverage meets thresholds (70% branches, 75% functions/lines/statements)
- [ ] TypeScript compiles without errors
- [ ] ESLint and Stylelint pass
- [ ] README.md is complete and accurate
- [ ] Storybook stories are comprehensive
- [ ] JSDoc comments are complete
- [ ] Figma Code Connect is implemented
- [ ] Component works in all supported browsers
- [ ] Component is keyboard accessible
- [ ] Component works with screen readers
- [ ] Component supports RTL languages
- [ ] Version bump is correct (MAJOR/MINOR/PATCH)
- [ ] Changelog is updated
- [ ] PR is approved and merged
- [ ] Package is published to npm
- [ ] Storybook is deployed

## Notes

### Key Backpack Patterns to Follow

1. **CSS Modules**: Always use `.module.scss` for component styles
2. **Modern Sass**: Use `@use` syntax, never `@import`
3. **Granular Imports**: Import specific mixins, not entire package
4. **Design Tokens**: Use tokens for all values (colors, spacing, typography)
5. **rem Units**: Always use `rem` for sizing, never `px` or `em`
6. **BEM Classes**: Use `bpk-component-name--modifier` pattern
7. **TypeScript**: All code in TypeScript, generate `.d.ts` files
8. **Accessibility**: Test with jest-axe, ensure keyboard nav and ARIA
9. **British English**: Prose in British English, code in US English
10. **Documentation**: <100 words, sentence case, singular titles

### Common Pitfalls to Avoid

1. ❌ Using `@import` in SCSS → ✅ Use `@use`
2. ❌ Using `px` units → ✅ Use `rem` units
3. ❌ Importing entire `bpk-mixins` → ✅ Import specific modules
4. ❌ Not namespacing mixins → ✅ Use `tokens.bpk-spacing-md()`
5. ❌ Skipping accessibility tests → ✅ Always include jest-axe tests
6. ❌ Using American English in docs → ✅ Use British English
7. ❌ Missing `@deprecated` tags → ✅ Document all deprecations
8. ❌ No runtime warnings for deprecated props → ✅ Add console.warn
9. ❌ Visual tests for image components → ✅ Skip visual tests if uses images
10. ❌ Testing implementation details → ✅ Test public interface

## References

- **Backpack Constitution**: `.specify/memory/constitution.md`
- **Architecture Decisions**: `decisions/` directory
- **Component Examples**: Browse `packages/` for similar components
- **Design Tokens**: `@skyscanner/bpk-foundations-web` and `packages/bpk-mixins/`
- **React Utilities**: `packages/bpk-react-utils/`
- **Theming**: `packages/bpk-theming/`
- **Storybook Examples**: `examples/` directory
- **Testing Patterns**: Review test files in existing components
